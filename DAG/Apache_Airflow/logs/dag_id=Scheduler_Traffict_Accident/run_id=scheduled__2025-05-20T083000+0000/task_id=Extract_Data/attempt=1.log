[2025-05-20T08:57:08.417+0000] {taskinstance.py:1171} INFO - Dependencies all met for <TaskInstance: Scheduler_Traffict_Accident.Extract_Data scheduled__2025-05-20T08:30:00+00:00 [queued]>
[2025-05-20T08:57:08.430+0000] {taskinstance.py:1171} INFO - Dependencies all met for <TaskInstance: Scheduler_Traffict_Accident.Extract_Data scheduled__2025-05-20T08:30:00+00:00 [queued]>
[2025-05-20T08:57:08.431+0000] {taskinstance.py:1368} INFO - 
--------------------------------------------------------------------------------
[2025-05-20T08:57:08.432+0000] {taskinstance.py:1369} INFO - Starting attempt 1 of 2
[2025-05-20T08:57:08.433+0000] {taskinstance.py:1370} INFO - 
--------------------------------------------------------------------------------
[2025-05-20T08:57:08.448+0000] {taskinstance.py:1389} INFO - Executing <Task(BashOperator): Extract_Data> on 2025-05-20 08:30:00+00:00
[2025-05-20T08:57:08.453+0000] {standard_task_runner.py:52} INFO - Started process 244 to run task
[2025-05-20T08:57:08.456+0000] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'Scheduler_Traffict_Accident', 'Extract_Data', 'scheduled__2025-05-20T08:30:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/Scheduler_Traffict_Accident.py', '--cfg-path', '/tmp/tmplp81luvc', '--error-file', '/tmp/tmpq3cwl8f2']
[2025-05-20T08:57:08.458+0000] {standard_task_runner.py:80} INFO - Job 2: Subtask Extract_Data
[2025-05-20T08:57:08.527+0000] {task_command.py:371} INFO - Running <TaskInstance: Scheduler_Traffict_Accident.Extract_Data scheduled__2025-05-20T08:30:00+00:00 [running]> on host f11a4c0b6787
[2025-05-20T08:57:08.605+0000] {taskinstance.py:1583} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Hisham
AIRFLOW_CTX_DAG_ID=Scheduler_Traffict_Accident
AIRFLOW_CTX_TASK_ID=Extract_Data
AIRFLOW_CTX_EXECUTION_DATE=2025-05-20T08:30:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2025-05-20T08:30:00+00:00
[2025-05-20T08:57:08.607+0000] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2025-05-20T08:57:08.608+0000] {subprocess.py:74} INFO - Running command: ['/bin/bash', '-c', 'sudo -u *** python /opt/***/scripts/Extract_Data.py']
[2025-05-20T08:57:08.617+0000] {subprocess.py:85} INFO - Output:
[2025-05-20T08:57:10.259+0000] {subprocess.py:92} INFO - WARNING: An illegal reflective access operation has occurred
[2025-05-20T08:57:10.260+0000] {subprocess.py:92} INFO - WARNING: Illegal reflective access by org.apache.spark.unsafe.Platform (file:/home/***/.local/lib/python3.7/site-packages/pyspark/jars/spark-unsafe_2.12-3.1.2.jar) to constructor java.nio.DirectByteBuffer(long,int)
[2025-05-20T08:57:10.261+0000] {subprocess.py:92} INFO - WARNING: Please consider reporting this to the maintainers of org.apache.spark.unsafe.Platform
[2025-05-20T08:57:10.261+0000] {subprocess.py:92} INFO - WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
[2025-05-20T08:57:10.262+0000] {subprocess.py:92} INFO - WARNING: All illegal access operations will be denied in a future release
[2025-05-20T08:57:10.421+0000] {subprocess.py:92} INFO - :: loading settings :: url = jar:file:/home/***/.local/lib/python3.7/site-packages/pyspark/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
[2025-05-20T08:57:10.495+0000] {subprocess.py:92} INFO - Ivy Default Cache set to: /home/***/.ivy2/cache
[2025-05-20T08:57:10.495+0000] {subprocess.py:92} INFO - The jars for the packages stored in: /home/***/.ivy2/jars
[2025-05-20T08:57:10.498+0000] {subprocess.py:92} INFO - org.postgresql#postgresql added as a dependency
[2025-05-20T08:57:10.499+0000] {subprocess.py:92} INFO - :: resolving dependencies :: org.apache.spark#spark-submit-parent-ed62fb80-4206-4257-bc04-8f3e6e9ebb74;1.0
[2025-05-20T08:57:10.500+0000] {subprocess.py:92} INFO - 	confs: [default]
[2025-05-20T08:57:12.553+0000] {subprocess.py:92} INFO - 	found org.postgresql#postgresql;42.6.0 in central
[2025-05-20T08:57:13.645+0000] {subprocess.py:92} INFO - 	found org.checkerframework#checker-qual;3.31.0 in central
[2025-05-20T08:57:13.658+0000] {subprocess.py:92} INFO - downloading https://repo1.maven.org/maven2/org/postgresql/postgresql/42.6.0/postgresql-42.6.0.jar ...
[2025-05-20T08:57:14.529+0000] {local_task_job.py:84} ERROR - Received SIGTERM. Terminating subprocesses
[2025-05-20T08:57:14.536+0000] {process_utils.py:129} INFO - Sending Signals.SIGTERM to group 244. PIDs of all processes in the group: [245, 248, 299, 244]
[2025-05-20T08:57:14.538+0000] {process_utils.py:80} INFO - Sending the signal Signals.SIGTERM to group 244
[2025-05-20T08:57:14.539+0000] {taskinstance.py:1553} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-05-20T08:57:14.540+0000] {subprocess.py:103} INFO - Sending SIGTERM signal to process group
[2025-05-20T08:57:14.548+0000] {process_utils.py:75} INFO - Process psutil.Process(pid=248, status='terminated', started='08:57:07') (248) terminated with exit code None
[2025-05-20T08:57:14.561+0000] {taskinstance.py:1902} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/bash.py", line 191, in execute
    cwd=self.cwd,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/subprocess.py", line 90, in run_command
    for raw_line in iter(self.sub_process.stdout.readline, b''):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1555, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2025-05-20T08:57:14.566+0000] {taskinstance.py:1412} INFO - Marking task as UP_FOR_RETRY. dag_id=Scheduler_Traffict_Accident, task_id=Extract_Data, execution_date=20250520T083000, start_date=20250520T085708, end_date=20250520T085714
[2025-05-20T08:57:14.577+0000] {process_utils.py:75} INFO - Process psutil.Process(pid=299, status='terminated', started='08:57:08') (299) terminated with exit code None
[2025-05-20T08:57:14.581+0000] {standard_task_runner.py:97} ERROR - Failed to execute job 2 for task Extract_Data (Task received SIGTERM signal; 244)
[2025-05-20T08:57:14.591+0000] {process_utils.py:75} INFO - Process psutil.Process(pid=244, status='terminated', exitcode=1, started='08:57:07') (244) terminated with exit code 1
[2025-05-20T08:57:14.592+0000] {process_utils.py:75} INFO - Process psutil.Process(pid=245, status='terminated', started='08:57:07') (245) terminated with exit code None
[2025-05-20T08:57:14.593+0000] {local_task_job.py:156} INFO - Task exited with return code 143
[2025-05-20T08:57:14.631+0000] {local_task_job.py:279} INFO - 0 downstream tasks scheduled from follow-on schedule check
